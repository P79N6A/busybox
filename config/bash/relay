#!/usr/bin/expect -f

#trap sigwinch spawned
trap {
	set rows [stty rows]
	set cols [stty columns]
	stty rows $rows columns $cols < $spawn_out(slave,name)
} WINCH

set machine [lindex $argv 0]
set screen  [lindex $argv 1]
set user gaowei08

switch -- $machine {
	""     { set machine gaowei08@cq01-rdqa-dev027.cq01.baidu.com }
	"dev"  { set machine gaowei08@cq01-rdqa-dev027.cq01.baidu.com }
	"test" { set machine work@yf-ps-beehive-test21.yf01 }
}

switch -- $screen {
	"" {set screen gaowei08}
}

puts "machine: $machine"
puts "screen:  $screen"

set timeout 4
spawn ssh gaowei08@relay01.baidu.com

expect {
	"bash-baidu-ssl" { send "ssh $machine\n" }
	"password" { interact }
}

send "screen -x $screen\n"
expect {
	"no screen" {
		send "screen -S $screen\n"
	}
}
interact

